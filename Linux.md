# Linux

## 1. shell 命令

### Linux目录

- ``/bin`` 存放二进制可执行文件（ls、cat、mkdir等）
- ``/etc`` 存放系统管理和配置文件
- ``/home`` 存放所有用户文件的根目录，用户主目录的基点
- ``/usr`` 用户存放系统应用程序/opt：额外安装的可选应用程序包所存放的位置
- ``/proc`` 虚拟文件系统目录，是系统内存的映射。可直接访问这个目录来获取系统信息
- ``/root`` 超级用户（系统管理员）的主目录（特权级别o）
- ``/sbin`` 存放二进制可执行文件，只有root才能访问。这里存放的是系统管理员使用的系统级别的管理命令和程序，如ifconfig
- ``/dev`` 用于存放设备文件
- ``/mnt`` 系统管理员安装临时文件系统的安装点，系统提供这个目录是让用户临时挂载其他的文件系统
- ``/boot`` 存放用于系统引导时使用的各种文件
- ``/lib`` 存放着和系统运行相关的库文件
- ``/tmp`` 用于存放各种临时文件，是公用的临时文件存储点
- ``/var`` 用于存放运行时需要改变数据的文件，也是某些大文件的溢出区，比如各种服务的日志文件（系统启动日志等）
- ``/lost+found`` 平时是空的，系统非正常关机而留下“无家可归”的文件

### 1.1 进程有关

通过程序监听的端口号查找程序

```bash
lsof -i :2379
```

杀死指定pid的进程

```bash
kill -9 16067
```

### 1.2 文件有关

在指定目录下查找文件

```sh
find . -iname "Channel*"
```

在当前目录下，查找名称以Channel开头的文件

## 1.3 概念

### 1.2.1 流与文件的区别

流是对IO设备（可以是网路、文件、输入输出设备）操作的封装；

### 文件存储

文件存储在硬盘上，硬盘的最小存储单位叫“扇区”（Sector）。每个扇区512字节（相当于0.5kb）。
操作系统读取硬盘时，为了提升效率，会一次性连续读取多个扇区（“块”Block），是文件存取的最小单位。块的大小，最常见为4KB，即连续八个sector组成一个block。

文件信息存储在“块”中，文件的元信息（创建者、文件的创建日期、文件的大小等），存储在inode（索引节点）区域。
每个文件都有inode，里面包含了与该文件有关的一些信息。

#### Linux文件系统如何通过i节点把文件的逻辑结构和物理结构转换？

inode节点是一个64字节长的表，表中包含了文件的相关信息，其中有文件的大小、文件的所有者、文件的存取许可方式以及文件的类型等重要信息。在inode节点表中最重要的内容是磁盘地址表。磁盘地址表中有13个号块，文件将以号块在磁盘地址表中出现的顺序依次读取相应的块。

Linux文件系统通过把inode节点和文件名进行连接，当需要读取文件时，文件系统在当前目录表中查找该文件名对应的项，由此得到该文件相对应的inode节点号，通过该inode节点的磁盘地址表把分散存放的物理文件块连接成文件的逻辑结构。

#### 硬连接与软连接

##### 硬链接

Linux下的文件通过索引节点（inode）来识别文件，硬链接可以认为是一个指针，指向文件索引节点的指针，系统并不为它重新分配inode。每添加一个硬链接，文件的链接数就加1。

1. 不可以在不同的文件系统的文件间建立链接
2. 只有超级用户才可以为目录创建硬链接

##### 软链接

软链接克服了硬链接的不足，没有任何文件系统的限制，任何用户可以创建指向目录的符号链接，可以跨越不同机器、不同网络文件进行链接；

1. 软链接有原文件的路径信息，所以当原文件从一个目录下移到其他目录中，再访问链接文件，系统就找不到了，硬链接没有这个缺陷；
2. 软链接需要系统分配额外的空间用于建立新的索引节点和保存原文件的路径；

硬链接不可跨分区，软链接可以跨分区；
硬链接指向一个inode节点，而软链接是创建一个新的inode节点；
删除硬链接文件，不会删除原文件，删除软链接文件，会把原文件删除；

### RAID 独立磁盘冗余阵列

基本思想：将多个相对便宜的的硬盘组合起来，成为一个硬盘阵列，使性能达到甚至超过一个价格昂贵、容量巨大的硬盘。RAID通常被用在服务器电脑上，使用完全相同的硬盘组成一个逻辑扇区，因此操作系统只会把它当作一个硬盘。

## Linux 安全

1. 添加普通用户登录，禁止root用户登录，更改``ssh``端口号；
2. 服务器使用密钥登录，禁止密码登录；
3. 开启防火墙，关闭SELinux，根据业务设置相应的防火墙规则；
4. 装fail2ban防止SSH暴力攻击；
5. 设置只允许公司办公网出口IP能登录服务器，安装VPN软件，只允许VPN链接VPN到服务器；
6. 修改历史命令记录条数为10条；
7. 只允许有需要的服务器可以访问外网，其它全部禁止；
8. 做好软件层面的防护：nginx_waf防止SQL注入；Web服务器用www用户启动，更改网站目录的所有者和所属组为www；

### CC攻击

攻击页面，模拟多个用户不停的对页面进行访问，从而使系统资源耗尽；

### DDOS攻击

DDOS攻击，分布式拒绝服务攻击，借助服务器技术将多个计算机联合起来作为攻击平台，来对一个或多个目标发动DDOS攻击；

### 预防攻击

攻击，即通过大量合法请求占用大量资源，以达到瘫痪网络的目的；

防止CC、DDOS攻击，只能使用硬件防火墙做流量清洗，将攻击流量引入黑洞。
